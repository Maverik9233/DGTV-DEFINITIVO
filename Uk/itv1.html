<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>ITV 1</title>
<script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
<script src="https://cdn.dashjs.org/latest/dash.all.min.js"></script>
<style>
  body {
    background: #000;
    color: #fff;
    text-align: center;
    margin: 0;
    font-family: Arial, sans-serif;
  }

  h1 {
    font-size: 26px;
    margin: 20px 0 15px 0;
    color: #00bfff;
    text-shadow: 0 0 12px rgba(0,191,255,0.7);
  }

  /* Player universale */
  #player-container {
    position: relative;
    display: inline-block;
  }

  video, iframe.stream {
    width: 960px;
    height: 540px;
    border: none;
    border-radius: 12px;
    box-shadow: 0 0 20px rgba(255,255,255,0.4);
    margin-bottom: 25px;
    background: #000;
  }

  /* Loader animato */
  .loader {
    position: absolute;
    top: 45%;
    left: 45%;
    width: 60px;
    height: 60px;
    border: 6px solid rgba(0,191,255,0.3);
    border-top-color: #00bfff;
    border-radius: 50%;
    animation: spin 1s linear infinite;
    z-index: 2;
  }

  @keyframes spin {
    to { transform: rotate(360deg); }
  }

  /* Guida TV */
  .epg-container {
    width: 960px;
    height: 500px;
    margin: 0 auto 50px auto;
    border-radius: 12px;
    overflow: hidden;
    position: relative;
    box-shadow: 0 0 15px rgba(0,191,255,0.3);
  }

  .epg-frame {
    width: 100%;
    height: 1500px;
    border: none;
    position: absolute;
    top: -500px; /* centratura perfetta */
    left: 0;
    transform: scale(1.02);
  }
</style>
</head>
<body>
  <h1>ðŸ“º ITV 1</h1>

  <!-- Player universale -->
  <div id="player-container">
    <div class="loader" id="loader"></div>
  </div>

  <script>
    const videoSrc = "https://www.livehdtv.com/embed/itv1/"; // ðŸ‘ˆ Inserisci qui il link video
    const container = document.getElementById("player-container");
    const loader = document.getElementById("loader");

    function removeLoader() {
      loader.style.display = "none";
    }

    // Rilevamento automatico del tipo di sorgente
    if (
      videoSrc.includes("embed") ||
      videoSrc.includes("iframe") ||
      videoSrc.endsWith(".php") ||
      videoSrc.endsWith(".html")
    ) {
      // Caso: EMBED / PHP / HTML â†’ usa iframe
      container.innerHTML = `
        <iframe class="stream"
          src="${videoSrc}"
          allow="autoplay; fullscreen"
          allowfullscreen
          scrolling="no"
          frameborder="0">
        </iframe>
      `;
      removeLoader();
    } else if (videoSrc.endsWith(".m3u8")) {
      // Caso: HLS
      container.innerHTML = `<video id="video" controls autoplay></video>`;
      const video = document.getElementById("video");
      if (Hls.isSupported()) {
        const hls = new Hls();
        hls.loadSource(videoSrc);
        hls.attachMedia(video);
        hls.on(Hls.Events.MANIFEST_PARSED, () => {
          video.play();
          removeLoader();
        });
      } else if (video.canPlayType("application/vnd.apple.mpegurl")) {
        video.src = videoSrc;
        video.play();
        removeLoader();
      }
    } else if (videoSrc.endsWith(".mpd")) {
      // Caso: MPEG-DASH
      container.innerHTML = `<video id="video" controls autoplay></video>`;
      const video = document.getElementById("video");
      const player = dashjs.MediaPlayer().create();
      player.initialize(video, videoSrc, true);
      player.on("playbackStarted", removeLoader);
    } else {
      // Fallback generico (.ts, .mp4, ecc.)
      container.innerHTML = `<video id="video" controls autoplay src="${videoSrc}"></video>`;
      const video = document.getElementById("video");
      video.onloadeddata = removeLoader;
    }
  </script>

  <!-- GUIDA TV CENTRATA -->
  <div class="epg-container">
    <iframe 
      class="epg-frame" 
      src="https://www.itv.com/watch/tv-guide/2025-10-27">
    </iframe>
  </div>
</body>
</html>
